"use strict";

class BuzzerControl {
  constructor(device) {
    this.device = device;

    //----------------------------------------------------------------------
    // Tunes are sequences of notes, notes are frequency (in multiples of 
    // 256us), duration (in multiples of 50ms) and delay (in ms)
    this.tuneSuccess = [
      [3, 2, 100],
      [12, 1, 100],
      [4, 2, 100],
      [12, 1, 100],
      [3, 2, 100],
      [12, 1, 100],
      [4, 2, 100],
      [12, 1, 100],
      [5, 2, 100],
      [12, 1, 100],
      [4, 2, 100],
      [12, 1, 100],
      [6, 2, 500],

      [3, 2, 100],
      [12, 1, 100],
      [4, 2, 100],
      [12, 1, 100],
      [3, 2, 100],
      [12, 1, 100],
      [4, 2, 100],
      [12, 1, 100],
      [5, 2, 100],
      [12, 1, 100],
      [4, 2, 100],
      [12, 1, 100],
      [6, 2, 0]
    ];

    this.tuneFailure = [
      [7, 8, 500],
      [7, 8, 500],
      [7, 8, 500],
      [9, 7, 350],
      [6, 3, 150],
      [7, 8, 500],
      [9, 7, 350],
      [6, 3, 150],
      [7, 8, 0]
    ];

    this.tuneArpeggio = [
      [1, 1, 50],
      [2, 1, 50],
      [3, 1, 50],
      [4, 1, 50],
      [5, 1, 50],
      [6, 1, 50],
      [7, 1, 50],
      [8, 1, 50],
      [9, 1, 50],
      [10, 1, 50],
      [11, 1, 50],
      [12, 1, 50],
      [11, 1, 50],
      [10, 1, 50],
      [9, 1, 50],
      [8, 1, 50],
      [7, 1, 50],
      [6, 1, 50],
      [5, 1, 50],
      [4, 1, 50],
      [3, 1, 50],
      [2, 1, 50],
      [1, 1, 50]
    ];

    //----------------------------------------------------------------------
  }

  playTune(tune) {
    var delay = 0;
    var device = this.device;
    tune.forEach(function (note) {
      setTimeout(function () {
        device.buzz(note[0], 1, note[1], 0);
      }, delay);
      delay += (note[2]);
    }, this);
  }

}

module.exports = BuzzerControl